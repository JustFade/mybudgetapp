{"ast":null,"code":"import React,{useState,useEffect,useMemo,createContext,useContext}from'react';import{initializeApp}from'firebase/app';import{getAuth,signInAnonymously,onAuthStateChanged,signInWithCustomToken}from'firebase/auth';import{getFirestore,collection,doc,onSnapshot,addDoc,updateDoc,deleteDoc,setDoc,query,writeBatch,getDoc,Timestamp}from'firebase/firestore';// --- Configuration & Constants ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig=typeof __firebase_config!=='undefined'?JSON.parse(__firebase_config):{};const appId=typeof __app_id!=='undefined'?__app_id:'family-organizer-app-v12';// --- Icon Components ---\nconst PlusCircle=_ref=>{let{className}=_ref;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"8\",x2:\"12\",y2:\"16\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"12\",x2:\"16\",y2:\"12\"})]});};const Trash2=_ref2=>{let{className}=_ref2;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]});};const X=_ref3=>{let{className}=_ref3;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]});};const Copy=_ref4=>{let{className}=_ref4;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"rect\",{x:\"9\",y:\"9\",width:\"13\",height:\"13\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"})]});};const PiggyBank=_ref5=>{let{className}=_ref5;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M19 5c-1.5 0-2.8 1-3.5 2.5a4.3 4.3 0 0 0-6.9 0A3.5 3.5 0 0 0 5 5c-2 0-3.5 1.5-3.5 3.5 0 2.2 1.9 4 4.3 4.8\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19.5 12.5c-2.4 0-4.4 1.5-5.2 3.5h-3.6c-.8-2-2.8-3.5-5.2-3.5C3.5 16 2 17.5 2 19.5S3.5 22 5.5 22h13c2 0 3.5-1.5 3.5-3.5s-1.5-3-3.5-3z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M10 16.5c0 .8.7 1.5 1.5 1.5s1.5-.7 1.5-1.5\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 5.5c-.3 0-.5.2-.5.5s.2.5.5.5.5-.2.5-.5-.2-.5-.5-.5z\"})]});};const Calendar=_ref6=>{let{className}=_ref6;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"4\",width:\"18\",height:\"18\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"2\",x2:\"16\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"2\",x2:\"8\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"10\",x2:\"21\",y2:\"10\"})]});};const Users=_ref7=>{let{className}=_ref7;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"9\",cy:\"7\",r:\"4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M23 21v-2a4 4 0 0 0-3-3.87\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\"})]});};const Clock=_ref8=>{let{className}=_ref8;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"12 6 12 12 16 14\"})]});};const ChevronLeft=_ref9=>{let{className}=_ref9;return/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:/*#__PURE__*/_jsx(\"polyline\",{points:\"15 18 9 12 15 6\"})});};const ChevronRight=_ref0=>{let{className}=_ref0;return/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:/*#__PURE__*/_jsx(\"polyline\",{points:\"9 18 15 12 9 6\"})});};const Settings=_ref1=>{let{className}=_ref1;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12.22 2h-4.44a2 2 0 0 0-2 2v.78a2 2 0 0 1-1.11 1.79l-.55.34a2 2 0 0 0-1.11 1.79v4.44a2 2 0 0 0 1.11 1.79l.55.34a2 2 0 0 1 1.11 1.79v.78a2 2 0 0 0 2 2h4.44a2 2 0 0 0 2-2v-.78a2 2 0 0 1 1.11-1.79l.55-.34a2 2 0 0 0 1.11-1.79v-4.44a2 2 0 0 0-1.11-1.79l-.55-.34a2 2 0 0 1-1.11-1.79V4a2 2 0 0 0-2-2z\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"3\"})]});};const Landmark=_ref10=>{let{className}=_ref10;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"22\",x2:\"21\",y2:\"22\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"18\",x2:\"6\",y2:\"11\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"18\",x2:\"10\",y2:\"11\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"18\",x2:\"14\",y2:\"11\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"18\",x2:\"18\",y2:\"11\"}),/*#__PURE__*/_jsx(\"polygon\",{points:\"12 2 20 7 4 7\"})]});};// --- Theme Context & Provider ---\nconst ThemeContext=/*#__PURE__*/createContext();const themes={light:{name:'Light'},dark:{name:'Dark'},mountain:{name:'Mountain Dawn'},ocean:{name:'Oceanic Calm'}};const ThemeProvider=_ref11=>{let{children}=_ref11;const[theme,setTheme]=useState(localStorage.getItem('appTheme')||'light');useEffect(()=>{const root=window.document.documentElement;Object.keys(themes).forEach(t=>root.classList.remove(t));root.classList.add(theme);localStorage.setItem('appTheme',theme);},[theme]);return/*#__PURE__*/_jsx(ThemeContext.Provider,{value:{theme,setTheme},children:children});};// --- Main App Component ---\nfunction App(){// --- State Management ---\nconst[db,setDb]=useState(null);const[isAuthReady,setIsAuthReady]=useState(false);const[budgetID,setBudgetID]=useState(localStorage.getItem('budgetID')||null);const[activeTab,setActiveTab]=useState('timeline');const[currentDate,setCurrentDate]=useState(new Date());// Lifted state\n// Data states\nconst[bills,setBills]=useState([]);// Recurring Bill Rules\nconst[deposits,setDeposits]=useState([]);// Recurring Deposit Rules\nconst[transactions,setTransactions]=useState([]);// Monthly Instances\nconst[savingsGoals,setSavingsGoals]=useState([]);const[loans,setLoans]=useState([]);const[appointments,setAppointments]=useState([]);const[contacts,setContacts]=useState([]);// UI states\nconst[joinInput,setJoinInput]=useState('');const[copySuccess,setCopySuccess]=useState('');const[modal,setModal]=useState({isOpen:false,type:null,data:null});// Unified modal state\nconst totalCurrentSavings=useMemo(()=>savingsGoals.reduce((sum,goal)=>sum+parseFloat(goal.current||0),0),[savingsGoals]);// --- Firebase Initialization & Auth ---\nuseEffect(()=>{if(Object.keys(firebaseConfig).length>0){const app=initializeApp(firebaseConfig);const authInstance=getAuth(app);setDb(getFirestore(app));onAuthStateChanged(authInstance,async user=>{if(!user){try{if(typeof __initial_auth_token!=='undefined'&&__initial_auth_token){await signInWithCustomToken(authInstance,__initial_auth_token);}else{await signInAnonymously(authInstance);}}catch(error){console.error(\"Error signing in:\",error);}}setIsAuthReady(true);});}else{setIsAuthReady(true);}},[]);// --- Data Fetching (based on budgetID) ---\nuseEffect(()=>{if(isAuthReady&&db&&budgetID){const basePath=`artifacts/${appId}/public/data/budgets/${budgetID}`;const createListener=(collectionName,setState)=>{return onSnapshot(query(collection(db,basePath,collectionName)),snap=>{const data=snap.docs.map(d=>{const docData=d.data();// Convert Firestore Timestamps to JS Dates\nObject.keys(docData).forEach(key=>{if(docData[key]&&docData[key].toDate){docData[key]=docData[key].toDate();}});return{id:d.id,...docData};});setState(data);});};const unsubscribers=[createListener('bills',setBills),// Rules\ncreateListener('deposits',setDeposits),// Rules\ncreateListener('transactions',setTransactions),// Instances\ncreateListener('savingsGoals',setSavingsGoals),createListener('loans',setLoans),createListener('appointments',setAppointments),createListener('contacts',setContacts)];return()=>unsubscribers.forEach(unsub=>unsub());}},[isAuthReady,db,budgetID]);// --- Handlers ---\nconst handleCreateBudget=()=>{const newID=crypto.randomUUID();localStorage.setItem('budgetID',newID);setBudgetID(newID);};const handleJoinBudget=()=>{if(joinInput.trim()){localStorage.setItem('budgetID',joinInput.trim());setBudgetID(joinInput.trim());}};const copyToClipboard=()=>{const textArea=document.createElement(\"textarea\");textArea.value=budgetID;document.body.appendChild(textArea);textArea.select();try{document.execCommand('copy');setCopySuccess('Copied!');setTimeout(()=>setCopySuccess(''),2000);}catch(err){setCopySuccess('Failed to copy');}document.body.removeChild(textArea);};const getBasePath=()=>`artifacts/${appId}/public/data/budgets/${budgetID}`;const handleSaveItem=async(type,data)=>{if(!db||!budgetID)return;const{id,...itemData}=data;let collectionName=`${type}s`;if(['bill','deposit','expense'].includes(type)){collectionName='transactions';}if(id){await updateDoc(doc(db,getBasePath(),collectionName,id),itemData);}else{const docRef=await addDoc(collection(db,getBasePath(),collectionName),{...itemData,type});if(type==='appointment'){if(itemData.cost&&parseFloat(itemData.cost)>0){await addDoc(collection(db,getBasePath(),'transactions'),{name:`Expense: ${itemData.name}`,amount:parseFloat(itemData.cost),date:itemData.date,type:'expense',linkedAppointmentId:docRef.id});}if(itemData.contactName||itemData.contactPhone||itemData.address){await addDoc(collection(db,getBasePath(),'contacts'),{name:itemData.contactName||itemData.name,phone:itemData.contactPhone||'',address:itemData.address||'',notes:`From appointment: ${itemData.name}`,linkedAppointmentId:docRef.id});}}}setModal({isOpen:false,type:null,data:null});};const handleDeleteItem=async(type,id)=>{if(!db||!budgetID)return;const collectionName=['bill','deposit','expense'].includes(type)?'transactions':`${type}s`;await deleteDoc(doc(db,getBasePath(),collectionName,id));setModal({isOpen:false,type:null,data:null});};const handleLoadSampleData=async()=>{if(!db||!budgetID)return;const batch=writeBatch(db);const basePath=getBasePath();const newSavingsGoalRef=doc(collection(db,basePath,'savingsGoals'));batch.set(newSavingsGoalRef,{name:\"Emergency Fund\",goal:1000,current:-46.64});const newLoanRef=doc(collection(db,basePath,'loans'));batch.set(newLoanRef,{name:\"Car Loan\",principal:15000,interestRate:5.5,minimumPayment:350});const depositsData=[{name:\"Your Paycheck\",amount:750,recurrence:'weekly',dayOfWeek:'3'},// Wednesday\n{name:\"Wife's Paycheck\",amount:936,recurrence:'bi-weekly',dayOfWeek:'5',startDate:new Date('2024-07-12')}];depositsData.forEach(item=>{const newDocRef=doc(collection(db,basePath,'deposits'));batch.set(newDocRef,item);});const billsData=[{name:'Rent',amount:1450,recurrence:'monthly',dayOfMonth:'1',contactInfo:'Landlord: 555-1234'},{name:'Car Payments',amount:900,recurrence:'monthly',dayOfMonth:'30'},{name:'Car Insurance (Proposed)',amount:450,recurrence:'monthly',dayOfMonth:'13'},{name:'Phone & Internet',amount:250,recurrence:'monthly',dayOfMonth:'2'},{name:'Childcare',amount:340,recurrence:'monthly',dayOfMonth:'5'},{name:'Tool Truck Bill',amount:50,recurrence:'weekly',dayOfWeek:'3'},{name:'Therapy',amount:50,recurrence:'weekly',dayOfWeek:'4'},{name:'Subscriptions',amount:43,recurrence:'monthly',dayOfMonth:'18'}];billsData.forEach(item=>{const newDocRef=doc(collection(db,basePath,'bills'));batch.set(newDocRef,item);});const newContactRef=doc(collection(db,basePath,'contacts'));batch.set(newContactRef,{name:'Eye Doctor',phone:'555-888-9999',email:'',notes:'Annual checkups'});await batch.commit();alert(\"Sample data loaded! The timeline will now generate for the current month.\");};// --- UI Components ---\nconst WelcomeScreen=()=>/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900 p-4 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2\",children:\"Family Organizer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400 mb-8\",children:\"Create a new shared space or join one your partner already made.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCreateBudget,className:\"w-full mb-4 px-6 py-3 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors shadow-md text-lg\",children:\"Create a New Space\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:joinInput,onChange:e=>setJoinInput(e.target.value),placeholder:\"Enter Space ID to join\",className:\"w-full p-3 bg-gray-200 dark:bg-gray-700 dark:text-white rounded-lg border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-center\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleJoinBudget,disabled:!joinInput.trim(),className:\"w-full px-6 py-2 rounded-lg bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\",children:\"Join Existing Space\"})]})]})});const MainLayout=_ref12=>{let{children}=_ref12;const{theme}=useContext(ThemeContext);let backgroundClass='bg-gray-100 dark:bg-gray-900';if(theme==='mountain')backgroundClass='bg-gradient-to-t from-gray-700 via-gray-900 to-black';if(theme==='ocean')backgroundClass='bg-gradient-to-t from-blue-700 via-blue-900 to-slate-900';return/*#__PURE__*/_jsxs(\"div\",{className:`${backgroundClass} min-h-screen font-sans text-gray-800 dark:text-gray-200 flex flex-col`,children:[/*#__PURE__*/_jsx(\"main\",{className:\"flex-grow container mx-auto p-4 md:p-8 mb-20\",children:children}),/*#__PURE__*/_jsx(\"footer\",{className:\"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 shadow-t-strong z-40\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"flex justify-around items-center h-16 max-w-screen-md mx-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('timeline'),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab==='timeline'?'text-blue-600 dark:text-blue-400':'text-gray-500 dark:text-gray-400'}`,children:[/*#__PURE__*/_jsx(Clock,{className:\"w-6 h-6 mb-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Timeline\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('savings'),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab==='savings'?'text-blue-600 dark:text-blue-400':'text-gray-500 dark:text-gray-400'}`,children:[/*#__PURE__*/_jsx(PiggyBank,{className:\"w-6 h-6 mb-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Savings\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('loans'),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab==='loans'?'text-blue-600 dark:text-blue-400':'text-gray-500 dark:text-gray-400'}`,children:[/*#__PURE__*/_jsx(Landmark,{className:\"w-6 h-6 mb-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Loans\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('schedule'),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab==='schedule'?'text-blue-600 dark:text-blue-400':'text-gray-500 dark:text-gray-400'}`,children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-6 h-6 mb-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Schedule\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('settings'),className:`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab==='settings'?'text-blue-600 dark:text-blue-400':'text-gray-500 dark:text-gray-400'}`,children:[/*#__PURE__*/_jsx(Settings,{className:\"w-6 h-6 mb-1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold\",children:\"Settings\"})]})]})}),modal.isOpen&&/*#__PURE__*/_jsx(ItemForm,{modalConfig:modal,onSave:handleSaveItem,onDelete:handleDeleteItem,onClose:()=>setModal({isOpen:false,type:null,data:null})})]});};// --- Page Components ---\nconst TimelinePage=_ref13=>{let{currentDate,setCurrentDate,bills,deposits,transactions,totalCurrentSavings,db,getBasePath}=_ref13;useEffect(()=>{const generateMonthlyInstances=async(year,month)=>{if(!db)return;const monthId=`${year}-${month}`;const generationRef=doc(db,getBasePath(),'generatedMonths',monthId);const generationDoc=await getDoc(generationRef);if(generationDoc.exists())return;const batch=writeBatch(db);const daysInMonth=new Date(year,month+1,0).getDate();const allRules=[...bills.map(b=>({...b,type:'bill'})),...deposits.map(d=>({...d,type:'deposit'}))];allRules.forEach(rule=>{const{id,...ruleData}=rule;if(rule.recurrence==='monthly'&&rule.dayOfMonth){const day=Math.min(parseInt(rule.dayOfMonth),daysInMonth);const date=new Date(year,month,day);const newDocRef=doc(collection(db,getBasePath(),'transactions'));batch.set(newDocRef,{...ruleData,date,ruleId:id});}else if(rule.recurrence==='weekly'&&rule.dayOfWeek){for(let day=1;day<=daysInMonth;day++){const date=new Date(year,month,day);if(date.getDay()===parseInt(rule.dayOfWeek)){const newDocRef=doc(collection(db,getBasePath(),'transactions'));batch.set(newDocRef,{...ruleData,date,ruleId:id});}}}else if(rule.recurrence==='bi-weekly'&&rule.dayOfWeek&&rule.startDate){const startDate=rule.startDate instanceof Date?rule.startDate:new Date(rule.startDate);for(let day=1;day<=daysInMonth;day++){const date=new Date(year,month,day);if(date.getDay()===parseInt(rule.dayOfWeek)&&Math.floor((date-startDate)/(1000*60*60*24))%14===0){const newDocRef=doc(collection(db,getBasePath(),'transactions'));batch.set(newDocRef,{...ruleData,date,ruleId:id});}}}});batch.set(generationRef,{generatedAt:Timestamp.now()});await batch.commit();};if((bills.length>0||deposits.length>0)&&db){generateMonthlyInstances(currentDate.getFullYear(),currentDate.getMonth());}},[currentDate,bills,deposits,db,getBasePath]);const dailyBreakdown=useMemo(()=>{const year=currentDate.getFullYear();const month=currentDate.getMonth();const daysInMonth=new Date(year,month+1,0).getDate();const monthTransactions=transactions.filter(t=>{const tDate=t.date instanceof Date?t.date:new Date(t.date);return tDate.getFullYear()===year&&tDate.getMonth()===month;});const eventsByDate={};monthTransactions.forEach(t=>{const dateStr=(t.date instanceof Date?t.date:new Date(t.date)).toDateString();if(!eventsByDate[dateStr])eventsByDate[dateStr]=[];eventsByDate[dateStr].push(t);});let runningBalance=totalCurrentSavings;const days=[];for(let day=1;day<=daysInMonth;day++){const date=new Date(year,month,day);const dateStr=date.toDateString();const dayEvents=(eventsByDate[dateStr]||[]).sort((a,b)=>a.name.localeCompare(b.name));dayEvents.forEach(event=>{const amount=parseFloat(event.amount||0);if(event.type==='deposit')runningBalance+=amount;else runningBalance-=amount;});days.push({date,events:dayEvents,endOfDayBalance:runningBalance});}return days;},[currentDate,transactions,totalCurrentSavings]);const changeMonth=offset=>{setCurrentDate(prev=>new Date(prev.getFullYear(),prev.getMonth()+offset,1));};const isDataEmpty=bills.length===0&&deposits.length===0&&transactions.length===0;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Cash Flow Timeline\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModal({isOpen:true,type:'expense'}),className:\"px-3 py-2 text-sm rounded-lg bg-yellow-500 text-white font-semibold hover:bg-yellow-600 shadow\",children:\"Add Expense\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4 mb-4 bg-white dark:bg-gray-800 p-2 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>changeMonth(-1),className:\"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:currentDate.toLocaleString('default',{month:'long',year:'numeric'})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>changeMonth(1),className:\"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-6 h-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-gray-600 dark:text-gray-400\",children:[\"Starting Balance for \",currentDate.toLocaleString('default',{month:'long'})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-gray-800 dark:text-gray-200\",children:[\"$\",parseFloat(totalCurrentSavings||0).toFixed(2)]})]})}),dailyBreakdown.map((day,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center border-b pb-2 mb-2 border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-700 dark:text-gray-300\",children:day.date.toLocaleDateString(undefined,{weekday:'long',month:'short',day:'numeric'})}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-lg\",children:[\"$\",day.endOfDayBalance.toFixed(2)]})]}),day.events.length>0?day.events.map((event,eventIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 -mx-4 px-4 rounded-lg\",onClick:()=>setModal({isOpen:true,type:event.type,data:event}),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:event.name}),/*#__PURE__*/_jsxs(\"p\",{className:`font-bold ${event.type==='deposit'?'text-green-500':'text-red-500'}`,children:[event.type==='deposit'?'+':'-',\"$\",parseFloat(event.amount||0).toFixed(2)]})]},event.id||eventIndex)):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 text-center py-2\",children:\"No transactions\"})]},index)),isDataEmpty&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-600 dark:text-gray-300\",children:\"Your Timeline is Empty\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 mt-2\",children:\"Load the sample plan to get started.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLoadSampleData,className:\"mt-6 px-6 py-3 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\",children:\"Load Our Plan\"})]})]})]});};const SavingsPage=()=>{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Savings Goals\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setModal({isOpen:true,type:'savingsGoal'}),className:\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add Goal\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:savingsGoals.length>0?savingsGoals.map(goal=>{const progress=goal.goal>0?goal.current/goal.goal*100:0;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer\",onClick:()=>setModal({isOpen:true,type:'savingsGoal',data:goal}),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg\",children:goal.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold\",children:[\"$\",parseFloat(goal.current||0).toFixed(2),\" / $\",parseFloat(goal.goal||0).toFixed(2)]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-4 rounded-full\",style:{width:`${progress>100?100:progress}%`}})})]},goal.id);}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 dark:text-gray-400 py-8\",children:\"No savings goals yet.\"})})]});};const LoansPage=()=>{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"header\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Loans\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setModal({isOpen:true,type:'loan'}),className:\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add Loan\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:loans.length>0?loans.map(loan=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer\",onClick:()=>setModal({isOpen:true,type:'loan',data:loan}),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg\",children:loan.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:[\"Balance: $\",parseFloat(loan.principal||0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:[\"Interest Rate: \",loan.interestRate,\"% | Min. Payment: $\",parseFloat(loan.minimumPayment||0).toFixed(2)]})]},loan.id)):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 dark:text-gray-400 py-8\",children:\"No loans to track.\"})})]});};const SchedulePage=()=>{const sortedAppointments=[...appointments].sort((a,b)=>new Date(a.date)-new Date(b.date));const allContacts=useMemo(()=>{const fromBills=bills.filter(b=>b.contactInfo).map(b=>({name:`${b.name} (Bill)`,phone:b.contactInfo,isFromBill:true}));return[...fromBills,...contacts].sort((a,b)=>a.name.localeCompare(b.name));},[bills,contacts]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Appointments\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setModal({isOpen:true,type:'appointment'}),className:\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:sortedAppointments.length>0?sortedAppointments.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700\",onClick:()=>setModal({isOpen:true,type:'appointment',data:item}),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:[new Date(item.date).toLocaleDateString(undefined,{weekday:'long',year:'numeric',month:'long',day:'numeric'}),\" at \",item.time]}),item.address&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 mt-1\",children:[\"Location: \",item.address]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 mt-1\",children:item.notes})]},item.id)):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 dark:text-gray-400 py-8\",children:\"No appointments scheduled.\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-12\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"mb-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Contacts\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setModal({isOpen:true,type:'contact'}),className:\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\",children:[/*#__PURE__*/_jsx(PlusCircle,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Add\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[allContacts.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700\",onClick:()=>!item.isFromBill&&setModal({isOpen:true,type:'contact',data:item}),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg\",children:item.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:item.phone}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:item.email}),item.address&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 dark:text-gray-400\",children:item.address}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400 mt-1\",children:item.notes})]},item.id||index)),allContacts.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 dark:text-gray-400 py-8\",children:\"No contacts found.\"})]})]})]});};const SettingsPage=()=>{const{theme,setTheme}=useContext(ThemeContext);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"header\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-800 dark:text-gray-200\",children:\"Settings\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-lg\",children:\"Theme\"}),/*#__PURE__*/_jsxs(\"select\",{value:theme,onChange:e=>setTheme(e.target.value),className:\"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"light\",children:\"Light\"}),/*#__PURE__*/_jsx(\"option\",{value:\"dark\",children:\"Dark\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mountain\",children:\"Mountain Dawn\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ocean\",children:\"Oceanic Calm\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-2\",children:\"Budget ID\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400 mb-4\",children:\"Share this ID with your partner to sync your budgets.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2 bg-gray-100 dark:bg-gray-700 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-600 dark:text-gray-300 break-all\",children:budgetID}),/*#__PURE__*/_jsx(\"button\",{onClick:copyToClipboard,className:\"text-blue-500 hover:text-blue-700 flex-shrink-0\",children:/*#__PURE__*/_jsx(Copy,{className:\"w-5 h-5\"})}),copySuccess&&/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 text-xs\",children:copySuccess})]})]})]})]});};const ItemForm=_ref14=>{let{modalConfig,onSave,onDelete,onClose}=_ref14;const{type,data}=modalConfig;const[formData,setFormData]=useState(data||{});const[isSaving,setIsSaving]=useState(false);const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setIsSaving(true);const dataToSave={...formData};if(dataToSave.date)dataToSave.date=new Date(dataToSave.date);if(dataToSave.startDate)dataToSave.startDate=new Date(dataToSave.startDate);await onSave(type,dataToSave);setIsSaving(false);};const renderFields=()=>{switch(type){case'bill':case'deposit':case'expense':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:formData.name||'',onChange:handleChange,placeholder:\"Name\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"amount\",value:formData.amount||'',onChange:handleChange,placeholder:\"Amount\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",value:formData.date?formData.date instanceof Date?formData.date.toISOString().split('T')[0]:formData.date:new Date().toISOString().split('T')[0],onChange:handleChange,className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),type==='bill'&&/*#__PURE__*/_jsx(\"textarea\",{name:\"contactInfo\",value:formData.contactInfo||'',onChange:handleChange,placeholder:\"Contact Info (Phone, etc.)\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"})]});case'savingsGoal':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:formData.name||'',onChange:handleChange,placeholder:\"Goal Name (e.g., Emergency Fund)\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"goal\",value:formData.goal||'',onChange:handleChange,placeholder:\"Goal Amount\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"current\",value:formData.current||'',onChange:handleChange,placeholder:\"Current Amount\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"})]});case'loan':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:formData.name||'',onChange:handleChange,placeholder:\"Loan Name (e.g., Car Loan)\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"principal\",value:formData.principal||'',onChange:handleChange,placeholder:\"Current Principal Balance\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"interestRate\",value:formData.interestRate||'',onChange:handleChange,placeholder:\"Interest Rate (%)\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"minimumPayment\",value:formData.minimumPayment||'',onChange:handleChange,placeholder:\"Minimum Monthly Payment\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true,step:\"0.01\"})]});case'appointment':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:formData.name||'',onChange:handleChange,placeholder:\"Appointment Title\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",value:formData.date?formData.date instanceof Date?formData.date.toISOString().split('T')[0]:formData.date:'',onChange:handleChange,className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",name:\"time\",value:formData.time||'',onChange:handleChange,className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"cost\",value:formData.cost||'',onChange:handleChange,placeholder:\"Optional Cost\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",step:\"0.01\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"address\",value:formData.address||'',onChange:handleChange,placeholder:\"Location / Address\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"notes\",value:formData.notes||'',onChange:handleChange,placeholder:\"Notes\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-2 text-gray-800 dark:text-gray-200\",children:\"Contact Info (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{name:\"contactName\",value:formData.contactName||'',onChange:handleChange,placeholder:\"Contact Name\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg mb-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"contactPhone\",value:formData.contactPhone||'',onChange:handleChange,placeholder:\"Contact Phone\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"})]})]});case'contact':return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{name:\"name\",value:formData.name||'',onChange:handleChange,placeholder:\"Contact Name\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:formData.phone||'',onChange:handleChange,placeholder:\"Phone Number\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email||'',onChange:handleChange,placeholder:\"Email Address\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"address\",value:formData.address||'',onChange:handleChange,placeholder:\"Address\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"notes\",value:formData.notes||'',onChange:handleChange,placeholder:\"Notes\",className:\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"})]});default:return null;}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-lg relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"absolute top-4 right-4 text-gray-400 hover:text-gray-700 dark:hover:text-gray-300\",children:/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"})}),/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800 dark:text-gray-200 mb-6 capitalize\",children:[data!==null&&data!==void 0&&data.id?'Edit':'Add',\" \",type]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[renderFields(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4\",children:[(data===null||data===void 0?void 0:data.id)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>onDelete(type,data.id),className:\"px-6 py-2 rounded-lg bg-red-600 text-white font-semibold hover:bg-red-700\",children:\"Delete\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"px-6 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 font-semibold hover:bg-gray-300 dark:hover:bg-gray-500\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isSaving,className:\"px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:opacity-50\",children:isSaving?'Saving...':'Save'})]})]})]})]})});};// --- Main Render Logic ---\nif(!isAuthReady)return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen bg-gray-100 dark:bg-gray-900\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-xl font-semibold text-gray-600 dark:text-gray-300\",children:\"Initializing Secure Session...\"})});if(!budgetID)return/*#__PURE__*/_jsx(WelcomeScreen,{});return/*#__PURE__*/_jsxs(MainLayout,{children:[activeTab==='timeline'&&/*#__PURE__*/_jsx(TimelinePage,{currentDate:currentDate,setCurrentDate:setCurrentDate,bills:bills,deposits:deposits,transactions:transactions,totalCurrentSavings:totalCurrentSavings,db:db,getBasePath:getBasePath}),activeTab==='savings'&&/*#__PURE__*/_jsx(SavingsPage,{savingsGoals:savingsGoals}),activeTab==='loans'&&/*#__PURE__*/_jsx(LoansPage,{loans:loans,transactions:transactions}),activeTab==='schedule'&&/*#__PURE__*/_jsx(SchedulePage,{appointments:appointments,contacts:contacts,bills:bills}),activeTab==='settings'&&/*#__PURE__*/_jsx(SettingsPage,{})]});}export default function ThemedApp(){return/*#__PURE__*/_jsx(ThemeProvider,{children:/*#__PURE__*/_jsx(App,{})});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","createContext","useContext","initializeApp","getAuth","signInAnonymously","onAuthStateChanged","signInWithCustomToken","getFirestore","collection","doc","onSnapshot","addDoc","updateDoc","deleteDoc","setDoc","query","writeBatch","getDoc","Timestamp","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","__firebase_config","JSON","parse","appId","__app_id","PlusCircle","_ref","className","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","children","cx","cy","r","x1","y1","x2","y2","Trash2","_ref2","points","d","X","_ref3","Copy","_ref4","x","y","rx","ry","PiggyBank","_ref5","Calendar","_ref6","Users","_ref7","Clock","_ref8","ChevronLeft","_ref9","ChevronRight","_ref0","Settings","_ref1","Landmark","_ref10","ThemeContext","themes","light","name","dark","mountain","ocean","ThemeProvider","_ref11","theme","setTheme","localStorage","getItem","root","window","document","documentElement","Object","keys","forEach","t","classList","remove","add","setItem","Provider","value","App","db","setDb","isAuthReady","setIsAuthReady","budgetID","setBudgetID","activeTab","setActiveTab","currentDate","setCurrentDate","Date","bills","setBills","deposits","setDeposits","transactions","setTransactions","savingsGoals","setSavingsGoals","loans","setLoans","appointments","setAppointments","contacts","setContacts","joinInput","setJoinInput","copySuccess","setCopySuccess","modal","setModal","isOpen","type","data","totalCurrentSavings","reduce","sum","goal","parseFloat","current","length","app","authInstance","user","__initial_auth_token","error","console","basePath","createListener","collectionName","setState","snap","docs","map","docData","key","toDate","id","unsubscribers","unsub","handleCreateBudget","newID","crypto","randomUUID","handleJoinBudget","trim","copyToClipboard","textArea","createElement","body","appendChild","select","execCommand","setTimeout","err","removeChild","getBasePath","handleSaveItem","itemData","includes","docRef","cost","amount","date","linkedAppointmentId","contactName","contactPhone","address","phone","notes","handleDeleteItem","handleLoadSampleData","batch","newSavingsGoalRef","set","newLoanRef","principal","interestRate","minimumPayment","depositsData","recurrence","dayOfWeek","startDate","item","newDocRef","billsData","dayOfMonth","contactInfo","newContactRef","email","commit","alert","WelcomeScreen","onClick","onChange","e","target","placeholder","disabled","MainLayout","_ref12","backgroundClass","ItemForm","modalConfig","onSave","onDelete","onClose","TimelinePage","_ref13","generateMonthlyInstances","year","month","monthId","generationRef","generationDoc","exists","daysInMonth","getDate","allRules","b","rule","ruleData","day","Math","min","parseInt","ruleId","getDay","floor","generatedAt","now","getFullYear","getMonth","dailyBreakdown","monthTransactions","filter","tDate","eventsByDate","dateStr","toDateString","push","runningBalance","days","dayEvents","sort","a","localeCompare","event","events","endOfDayBalance","changeMonth","offset","prev","isDataEmpty","toLocaleString","toFixed","index","toLocaleDateString","undefined","weekday","eventIndex","SavingsPage","progress","style","LoansPage","loan","SchedulePage","sortedAppointments","allContacts","fromBills","isFromBill","time","SettingsPage","_ref14","formData","setFormData","isSaving","setIsSaving","handleChange","handleSubmit","preventDefault","dataToSave","renderFields","required","step","toISOString","split","onSubmit","ThemedApp"],"sources":["C:/Users/Johnj/my-budgeting-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, createContext, useContext } from 'react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from 'firebase/auth';\r\nimport { getFirestore, collection, doc, onSnapshot, addDoc, updateDoc, deleteDoc, setDoc, query, writeBatch, getDoc, Timestamp } from 'firebase/firestore';\r\n\r\n// --- Configuration & Constants ---\r\nconst firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};\r\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'family-organizer-app-v12';\r\n\r\n// --- Icon Components ---\r\nconst PlusCircle = ({ className }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line><line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line></svg>);\r\nconst Trash2 = ({ className }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><polyline points=\"3 6 5 6 21 6\"></polyline><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line></svg>);\r\nconst X = ({ className }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>);\r\nconst Copy = ({ className }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect><path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path></svg>);\r\nconst PiggyBank = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M19 5c-1.5 0-2.8 1-3.5 2.5a4.3 4.3 0 0 0-6.9 0A3.5 3.5 0 0 0 5 5c-2 0-3.5 1.5-3.5 3.5 0 2.2 1.9 4 4.3 4.8\"/><path d=\"M19.5 12.5c-2.4 0-4.4 1.5-5.2 3.5h-3.6c-.8-2-2.8-3.5-5.2-3.5C3.5 16 2 17.5 2 19.5S3.5 22 5.5 22h13c2 0 3.5-1.5 3.5-3.5s-1.5-3-3.5-3z\"/><path d=\"M10 16.5c0 .8.7 1.5 1.5 1.5s1.5-.7 1.5-1.5\"/><path d=\"M16 5.5c-.3 0-.5.2-.5.5s.2.5.5.5.5-.2.5-.5-.2-.5-.5-.5z\"/></svg>;\r\nconst Calendar = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"></line><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"></line><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"></line></svg>;\r\nconst Users = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"></path><circle cx=\"9\" cy=\"7\" r=\"4\"></circle><path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"></path><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"></path></svg>;\r\nconst Clock = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>;\r\nconst ChevronLeft = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><polyline points=\"15 18 9 12 15 6\"></polyline></svg>;\r\nconst ChevronRight = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><polyline points=\"9 18 15 12 9 6\"></polyline></svg>;\r\nconst Settings = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M12.22 2h-4.44a2 2 0 0 0-2 2v.78a2 2 0 0 1-1.11 1.79l-.55.34a2 2 0 0 0-1.11 1.79v4.44a2 2 0 0 0 1.11 1.79l.55.34a2 2 0 0 1 1.11 1.79v.78a2 2 0 0 0 2 2h4.44a2 2 0 0 0 2-2v-.78a2 2 0 0 1 1.11-1.79l.55-.34a2 2 0 0 0 1.11-1.79v-4.44a2 2 0 0 0-1.11-1.79l-.55-.34a2 2 0 0 1-1.11-1.79V4a2 2 0 0 0-2-2z\"></path><circle cx=\"12\" cy=\"12\" r=\"3\"></circle></svg>;\r\nconst Landmark = ({ className }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><line x1=\"3\" y1=\"22\" x2=\"21\" y2=\"22\"></line><line x1=\"6\" y1=\"18\" x2=\"6\" y2=\"11\"></line><line x1=\"10\" y1=\"18\" x2=\"10\" y2=\"11\"></line><line x1=\"14\" y1=\"18\" x2=\"14\" y2=\"11\"></line><line x1=\"18\" y1=\"18\" x2=\"18\" y2=\"11\"></line><polygon points=\"12 2 20 7 4 7\"></polygon></svg>;\r\n\r\n\r\n// --- Theme Context & Provider ---\r\nconst ThemeContext = createContext();\r\n\r\nconst themes = {\r\n  light: { name: 'Light' },\r\n  dark: { name: 'Dark' },\r\n  mountain: { name: 'Mountain Dawn' },\r\n  ocean: { name: 'Oceanic Calm' },\r\n};\r\n\r\nconst ThemeProvider = ({ children }) => {\r\n    const [theme, setTheme] = useState(localStorage.getItem('appTheme') || 'light');\r\n\r\n    useEffect(() => {\r\n        const root = window.document.documentElement;\r\n        Object.keys(themes).forEach(t => root.classList.remove(t));\r\n        root.classList.add(theme);\r\n        localStorage.setItem('appTheme', theme);\r\n    }, [theme]);\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, setTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n};\r\n\r\n// --- Main App Component ---\r\nfunction App() {\r\n  // --- State Management ---\r\n  const [db, setDb] = useState(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n  const [budgetID, setBudgetID] = useState(localStorage.getItem('budgetID') || null);\r\n  const [activeTab, setActiveTab] = useState('timeline');\r\n  const [currentDate, setCurrentDate] = useState(new Date()); // Lifted state\r\n  \r\n  // Data states\r\n  const [bills, setBills] = useState([]); // Recurring Bill Rules\r\n  const [deposits, setDeposits] =useState([]); // Recurring Deposit Rules\r\n  const [transactions, setTransactions] = useState([]); // Monthly Instances\r\n  const [savingsGoals, setSavingsGoals] = useState([]);\r\n  const [loans, setLoans] = useState([]);\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [contacts, setContacts] = useState([]);\r\n\r\n  // UI states\r\n  const [joinInput, setJoinInput] = useState('');\r\n  const [copySuccess, setCopySuccess] = useState('');\r\n  const [modal, setModal] = useState({ isOpen: false, type: null, data: null }); // Unified modal state\r\n\r\n  const totalCurrentSavings = useMemo(() => savingsGoals.reduce((sum, goal) => sum + parseFloat(goal.current || 0), 0), [savingsGoals]);\r\n\r\n  // --- Firebase Initialization & Auth ---\r\n  useEffect(() => {\r\n    if (Object.keys(firebaseConfig).length > 0) {\r\n      const app = initializeApp(firebaseConfig);\r\n      const authInstance = getAuth(app);\r\n      setDb(getFirestore(app));\r\n      onAuthStateChanged(authInstance, async (user) => {\r\n        if (!user) {\r\n          try {\r\n            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {\r\n              await signInWithCustomToken(authInstance, __initial_auth_token);\r\n            } else { await signInAnonymously(authInstance); }\r\n          } catch (error) { console.error(\"Error signing in:\", error); }\r\n        }\r\n        setIsAuthReady(true);\r\n      });\r\n    } else { setIsAuthReady(true); }\r\n  }, []);\r\n\r\n  // --- Data Fetching (based on budgetID) ---\r\n  useEffect(() => {\r\n    if (isAuthReady && db && budgetID) {\r\n      const basePath = `artifacts/${appId}/public/data/budgets/${budgetID}`;\r\n      \r\n      const createListener = (collectionName, setState) => {\r\n          return onSnapshot(query(collection(db, basePath, collectionName)), snap => {\r\n              const data = snap.docs.map(d => {\r\n                  const docData = d.data();\r\n                  // Convert Firestore Timestamps to JS Dates\r\n                  Object.keys(docData).forEach(key => {\r\n                      if (docData[key] && docData[key].toDate) {\r\n                          docData[key] = docData[key].toDate();\r\n                      }\r\n                  });\r\n                  return { id: d.id, ...docData };\r\n              });\r\n              setState(data);\r\n          });\r\n      };\r\n\r\n      const unsubscribers = [\r\n        createListener('bills', setBills), // Rules\r\n        createListener('deposits', setDeposits), // Rules\r\n        createListener('transactions', setTransactions), // Instances\r\n        createListener('savingsGoals', setSavingsGoals),\r\n        createListener('loans', setLoans),\r\n        createListener('appointments', setAppointments),\r\n        createListener('contacts', setContacts),\r\n      ];\r\n      return () => unsubscribers.forEach(unsub => unsub());\r\n    }\r\n  }, [isAuthReady, db, budgetID]);\r\n\r\n  // --- Handlers ---\r\n  const handleCreateBudget = () => {\r\n    const newID = crypto.randomUUID();\r\n    localStorage.setItem('budgetID', newID);\r\n    setBudgetID(newID);\r\n  };\r\n\r\n  const handleJoinBudget = () => {\r\n    if (joinInput.trim()) {\r\n      localStorage.setItem('budgetID', joinInput.trim());\r\n      setBudgetID(joinInput.trim());\r\n    }\r\n  };\r\n  \r\n  const copyToClipboard = () => {\r\n    const textArea = document.createElement(\"textarea\");\r\n    textArea.value = budgetID;\r\n    document.body.appendChild(textArea);\r\n    textArea.select();\r\n    try {\r\n        document.execCommand('copy');\r\n        setCopySuccess('Copied!');\r\n        setTimeout(() => setCopySuccess(''), 2000);\r\n    } catch (err) { setCopySuccess('Failed to copy'); }\r\n    document.body.removeChild(textArea);\r\n  };\r\n\r\n  const getBasePath = () => `artifacts/${appId}/public/data/budgets/${budgetID}`;\r\n\r\n  const handleSaveItem = async (type, data) => {\r\n    if (!db || !budgetID) return;\r\n    const { id, ...itemData } = data;\r\n    \r\n    let collectionName = `${type}s`;\r\n    if (['bill', 'deposit', 'expense'].includes(type)) {\r\n        collectionName = 'transactions';\r\n    }\r\n    \r\n    if (id) {\r\n        await updateDoc(doc(db, getBasePath(), collectionName, id), itemData);\r\n    } else {\r\n        const docRef = await addDoc(collection(db, getBasePath(), collectionName), { ...itemData, type });\r\n        if (type === 'appointment') {\r\n            if (itemData.cost && parseFloat(itemData.cost) > 0) {\r\n                await addDoc(collection(db, getBasePath(), 'transactions'), {\r\n                    name: `Expense: ${itemData.name}`,\r\n                    amount: parseFloat(itemData.cost),\r\n                    date: itemData.date,\r\n                    type: 'expense',\r\n                    linkedAppointmentId: docRef.id\r\n                });\r\n            }\r\n            if (itemData.contactName || itemData.contactPhone || itemData.address) {\r\n                await addDoc(collection(db, getBasePath(), 'contacts'), {\r\n                    name: itemData.contactName || itemData.name,\r\n                    phone: itemData.contactPhone || '',\r\n                    address: itemData.address || '',\r\n                    notes: `From appointment: ${itemData.name}`,\r\n                    linkedAppointmentId: docRef.id\r\n                });\r\n            }\r\n        }\r\n    }\r\n    setModal({ isOpen: false, type: null, data: null });\r\n  };\r\n\r\n  const handleDeleteItem = async (type, id) => {\r\n    if (!db || !budgetID) return;\r\n    const collectionName = ['bill', 'deposit', 'expense'].includes(type) ? 'transactions' : `${type}s`;\r\n    await deleteDoc(doc(db, getBasePath(), collectionName, id));\r\n    setModal({ isOpen: false, type: null, data: null });\r\n  };\r\n\r\n  const handleLoadSampleData = async () => {\r\n    if (!db || !budgetID) return;\r\n    const batch = writeBatch(db);\r\n    const basePath = getBasePath();\r\n    \r\n    const newSavingsGoalRef = doc(collection(db, basePath, 'savingsGoals'));\r\n    batch.set(newSavingsGoalRef, { name: \"Emergency Fund\", goal: 1000, current: -46.64 });\r\n    \r\n    const newLoanRef = doc(collection(db, basePath, 'loans'));\r\n    batch.set(newLoanRef, { name: \"Car Loan\", principal: 15000, interestRate: 5.5, minimumPayment: 350 });\r\n\r\n    const depositsData = [\r\n        { name: \"Your Paycheck\", amount: 750, recurrence: 'weekly', dayOfWeek: '3' }, // Wednesday\r\n        { name: \"Wife's Paycheck\", amount: 936, recurrence: 'bi-weekly', dayOfWeek: '5', startDate: new Date('2024-07-12') }\r\n    ];\r\n    depositsData.forEach(item => {\r\n        const newDocRef = doc(collection(db, basePath, 'deposits'));\r\n        batch.set(newDocRef, item);\r\n    });\r\n\r\n    const billsData = [\r\n        { name: 'Rent', amount: 1450, recurrence: 'monthly', dayOfMonth: '1', contactInfo: 'Landlord: 555-1234' },\r\n        { name: 'Car Payments', amount: 900, recurrence: 'monthly', dayOfMonth: '30' },\r\n        { name: 'Car Insurance (Proposed)', amount: 450, recurrence: 'monthly', dayOfMonth: '13' },\r\n        { name: 'Phone & Internet', amount: 250, recurrence: 'monthly', dayOfMonth: '2' },\r\n        { name: 'Childcare', amount: 340, recurrence: 'monthly', dayOfMonth: '5' },\r\n        { name: 'Tool Truck Bill', amount: 50, recurrence: 'weekly', dayOfWeek: '3' },\r\n        { name: 'Therapy', amount: 50, recurrence: 'weekly', dayOfWeek: '4' },\r\n        { name: 'Subscriptions', amount: 43, recurrence: 'monthly', dayOfMonth: '18' },\r\n    ];\r\n    billsData.forEach(item => {\r\n        const newDocRef = doc(collection(db, basePath, 'bills'));\r\n        batch.set(newDocRef, item);\r\n    });\r\n\r\n    const newContactRef = doc(collection(db, basePath, 'contacts'));\r\n    batch.set(newContactRef, { name: 'Eye Doctor', phone: '555-888-9999', email: '', notes: 'Annual checkups' });\r\n\r\n    await batch.commit();\r\n    alert(\"Sample data loaded! The timeline will now generate for the current month.\");\r\n  };\r\n\r\n  // --- UI Components ---\r\n  const WelcomeScreen = () => (\r\n    <div className=\"flex flex-col items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900 p-4 text-center\">\r\n      <div className=\"w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg\">\r\n        <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200 mb-2\">Family Organizer</h1>\r\n        <p className=\"text-gray-500 dark:text-gray-400 mb-8\">Create a new shared space or join one your partner already made.</p>\r\n        <button onClick={handleCreateBudget} className=\"w-full mb-4 px-6 py-3 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-colors shadow-md text-lg\">Create a New Space</button>\r\n        <div className=\"space-y-2\">\r\n            <input type=\"text\" value={joinInput} onChange={(e) => setJoinInput(e.target.value)} placeholder=\"Enter Space ID to join\" className=\"w-full p-3 bg-gray-200 dark:bg-gray-700 dark:text-white rounded-lg border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-center\"/>\r\n            <button onClick={handleJoinBudget} disabled={!joinInput.trim()} className=\"w-full px-6 py-2 rounded-lg bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold hover:bg-gray-400 dark:hover:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\">Join Existing Space</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const MainLayout = ({ children }) => {\r\n      const { theme } = useContext(ThemeContext);\r\n      let backgroundClass = 'bg-gray-100 dark:bg-gray-900';\r\n      if (theme === 'mountain') backgroundClass = 'bg-gradient-to-t from-gray-700 via-gray-900 to-black';\r\n      if (theme === 'ocean') backgroundClass = 'bg-gradient-to-t from-blue-700 via-blue-900 to-slate-900';\r\n\r\n      return (\r\n        <div className={`${backgroundClass} min-h-screen font-sans text-gray-800 dark:text-gray-200 flex flex-col`}>\r\n          <main className=\"flex-grow container mx-auto p-4 md:p-8 mb-20\">\r\n            {children}\r\n          </main>\r\n          <footer className=\"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 shadow-t-strong z-40\">\r\n            <nav className=\"flex justify-around items-center h-16 max-w-screen-md mx-auto\">\r\n              <button onClick={() => setActiveTab('timeline')} className={`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab === 'timeline' ? 'text-blue-600 dark:text-blue-400' : 'text-gray-500 dark:text-gray-400'}`}>\r\n                <Clock className=\"w-6 h-6 mb-1\"/>\r\n                <span className=\"text-xs font-semibold\">Timeline</span>\r\n              </button>\r\n              <button onClick={() => setActiveTab('savings')} className={`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab === 'savings' ? 'text-blue-600 dark:text-blue-400' : 'text-gray-500 dark:text-gray-400'}`}>\r\n                <PiggyBank className=\"w-6 h-6 mb-1\"/>\r\n                <span className=\"text-xs font-semibold\">Savings</span>\r\n              </button>\r\n              <button onClick={() => setActiveTab('loans')} className={`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab === 'loans' ? 'text-blue-600 dark:text-blue-400' : 'text-gray-500 dark:text-gray-400'}`}>\r\n                <Landmark className=\"w-6 h-6 mb-1\"/>\r\n                <span className=\"text-xs font-semibold\">Loans</span>\r\n              </button>\r\n               <button onClick={() => setActiveTab('schedule')} className={`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab === 'schedule' ? 'text-blue-600 dark:text-blue-400' : 'text-gray-500 dark:text-gray-400'}`}>\r\n                <Calendar className=\"w-6 h-6 mb-1\"/>\r\n                <span className=\"text-xs font-semibold\">Schedule</span>\r\n              </button>\r\n              <button onClick={() => setActiveTab('settings')} className={`flex flex-col items-center justify-center w-full h-full transition-colors ${activeTab === 'settings' ? 'text-blue-600 dark:text-blue-400' : 'text-gray-500 dark:text-gray-400'}`}>\r\n                <Settings className=\"w-6 h-6 mb-1\"/>\r\n                <span className=\"text-xs font-semibold\">Settings</span>\r\n              </button>\r\n            </nav>\r\n          </footer>\r\n          {modal.isOpen && <ItemForm modalConfig={modal} onSave={handleSaveItem} onDelete={handleDeleteItem} onClose={() => setModal({isOpen: false, type: null, data: null})} />}\r\n        </div>\r\n      );\r\n  };\r\n  \r\n  // --- Page Components ---\r\n  const TimelinePage = ({ currentDate, setCurrentDate, bills, deposits, transactions, totalCurrentSavings, db, getBasePath }) => {\r\n    \r\n    useEffect(() => {\r\n        const generateMonthlyInstances = async (year, month) => {\r\n            if (!db) return;\r\n            const monthId = `${year}-${month}`;\r\n            const generationRef = doc(db, getBasePath(), 'generatedMonths', monthId);\r\n            const generationDoc = await getDoc(generationRef);\r\n\r\n            if (generationDoc.exists()) return;\r\n\r\n            const batch = writeBatch(db);\r\n            const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n            const allRules = [...bills.map(b => ({...b, type: 'bill'})), ...deposits.map(d => ({...d, type: 'deposit'}))];\r\n\r\n            allRules.forEach(rule => {\r\n                const { id, ...ruleData } = rule;\r\n                if (rule.recurrence === 'monthly' && rule.dayOfMonth) {\r\n                    const day = Math.min(parseInt(rule.dayOfMonth), daysInMonth);\r\n                    const date = new Date(year, month, day);\r\n                    const newDocRef = doc(collection(db, getBasePath(), 'transactions'));\r\n                    batch.set(newDocRef, { ...ruleData, date, ruleId: id });\r\n                } else if (rule.recurrence === 'weekly' && rule.dayOfWeek) {\r\n                     for (let day = 1; day <= daysInMonth; day++) {\r\n                        const date = new Date(year, month, day);\r\n                        if (date.getDay() === parseInt(rule.dayOfWeek)) {\r\n                            const newDocRef = doc(collection(db, getBasePath(), 'transactions'));\r\n                            batch.set(newDocRef, { ...ruleData, date, ruleId: id });\r\n                        }\r\n                    }\r\n                } else if (rule.recurrence === 'bi-weekly' && rule.dayOfWeek && rule.startDate) {\r\n                    const startDate = rule.startDate instanceof Date ? rule.startDate : new Date(rule.startDate);\r\n                    for (let day = 1; day <= daysInMonth; day++) {\r\n                        const date = new Date(year, month, day);\r\n                        if (date.getDay() === parseInt(rule.dayOfWeek) && (Math.floor((date - startDate) / (1000 * 60 * 60 * 24)) % 14 === 0)) {\r\n                             const newDocRef = doc(collection(db, getBasePath(), 'transactions'));\r\n                             batch.set(newDocRef, { ...ruleData, date, ruleId: id });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            batch.set(generationRef, { generatedAt: Timestamp.now() });\r\n            await batch.commit();\r\n        };\r\n\r\n        if ((bills.length > 0 || deposits.length > 0) && db) {\r\n            generateMonthlyInstances(currentDate.getFullYear(), currentDate.getMonth());\r\n        }\r\n    }, [currentDate, bills, deposits, db, getBasePath]);\r\n\r\n    const dailyBreakdown = useMemo(() => {\r\n        const year = currentDate.getFullYear();\r\n        const month = currentDate.getMonth();\r\n        const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n        \r\n        const monthTransactions = transactions.filter(t => {\r\n            const tDate = t.date instanceof Date ? t.date : new Date(t.date);\r\n            return tDate.getFullYear() === year && tDate.getMonth() === month;\r\n        });\r\n\r\n        const eventsByDate = {};\r\n        monthTransactions.forEach(t => {\r\n            const dateStr = (t.date instanceof Date ? t.date : new Date(t.date)).toDateString();\r\n            if (!eventsByDate[dateStr]) eventsByDate[dateStr] = [];\r\n            eventsByDate[dateStr].push(t);\r\n        });\r\n\r\n        let runningBalance = totalCurrentSavings; \r\n        const days = [];\r\n        for (let day = 1; day <= daysInMonth; day++) {\r\n            const date = new Date(year, month, day);\r\n            const dateStr = date.toDateString();\r\n            const dayEvents = (eventsByDate[dateStr] || []).sort((a,b) => a.name.localeCompare(b.name));\r\n            \r\n            dayEvents.forEach(event => {\r\n                const amount = parseFloat(event.amount || 0);\r\n                if (event.type === 'deposit') runningBalance += amount;\r\n                else runningBalance -= amount;\r\n            });\r\n\r\n            days.push({\r\n                date,\r\n                events: dayEvents,\r\n                endOfDayBalance: runningBalance\r\n            });\r\n        }\r\n        return days;\r\n\r\n    }, [currentDate, transactions, totalCurrentSavings]);\r\n\r\n    const changeMonth = (offset) => {\r\n        setCurrentDate(prev => new Date(prev.getFullYear(), prev.getMonth() + offset, 1));\r\n    };\r\n\r\n    const isDataEmpty = bills.length === 0 && deposits.length === 0 && transactions.length === 0;\r\n\r\n    return (\r\n        <div>\r\n            <header className=\"mb-6 flex justify-between items-center\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Cash Flow Timeline</h1>\r\n                <div className=\"flex space-x-2\">\r\n                    <button onClick={() => setModal({isOpen: true, type: 'expense'})} className=\"px-3 py-2 text-sm rounded-lg bg-yellow-500 text-white font-semibold hover:bg-yellow-600 shadow\">Add Expense</button>\r\n                </div>\r\n            </header>\r\n            <div className=\"flex justify-between items-center mt-4 mb-4 bg-white dark:bg-gray-800 p-2 rounded-lg shadow\">\r\n                <button onClick={() => changeMonth(-1)} className=\"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700\"><ChevronLeft className=\"w-6 h-6\"/></button>\r\n                <h2 className=\"text-xl font-semibold\">{currentDate.toLocaleString('default', { month: 'long', year: 'numeric' })}</h2>\r\n                <button onClick={() => changeMonth(1)} className=\"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700\"><ChevronRight className=\"w-6 h-6\"/></button>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n                <div className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <span className=\"font-medium text-gray-600 dark:text-gray-400\">Starting Balance for {currentDate.toLocaleString('default', { month: 'long' })}</span>\r\n                        <span className=\"font-bold text-lg text-gray-800 dark:text-gray-200\">${parseFloat(totalCurrentSavings || 0).toFixed(2)}</span>\r\n                    </div>\r\n                </div>\r\n                {dailyBreakdown.map((day, index) => (\r\n                    <div key={index} className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow\">\r\n                        <div className=\"flex justify-between items-center border-b pb-2 mb-2 border-gray-200 dark:border-gray-700\">\r\n                             <h3 className=\"font-bold text-gray-700 dark:text-gray-300\">{day.date.toLocaleDateString(undefined, { weekday: 'long', month: 'short', day: 'numeric' })}</h3>\r\n                             <p className=\"font-bold text-lg\">${day.endOfDayBalance.toFixed(2)}</p>\r\n                        </div>\r\n                        {day.events.length > 0 ? day.events.map((event, eventIndex) => (\r\n                            <div key={event.id || eventIndex} className=\"flex items-center justify-between py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 -mx-4 px-4 rounded-lg\" onClick={() => setModal({isOpen: true, type: event.type, data: event})}>\r\n                                <p className=\"font-semibold\">{event.name}</p>\r\n                                <p className={`font-bold ${event.type === 'deposit' ? 'text-green-500' : 'text-red-500'}`}>\r\n                                    {event.type === 'deposit' ? '+' : '-'}${parseFloat(event.amount || 0).toFixed(2)}\r\n                                </p>\r\n                            </div>\r\n                        )) : <p className=\"text-sm text-gray-500 dark:text-gray-400 text-center py-2\">No transactions</p>}\r\n                    </div>\r\n                ))}\r\n                 {isDataEmpty && <div className=\"text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow\"><h3 className=\"text-xl font-semibold text-gray-600 dark:text-gray-300\">Your Timeline is Empty</h3><p className=\"text-gray-400 mt-2\">Load the sample plan to get started.</p><button onClick={handleLoadSampleData} className=\"mt-6 px-6 py-3 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\">Load Our Plan</button></div>}\r\n            </div>\r\n        </div>\r\n    );\r\n  };\r\n  \r\n  const SavingsPage = () => {\r\n    return (\r\n        <div>\r\n            <header className=\"mb-6 flex justify-between items-center\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Savings Goals</h1>\r\n                <button onClick={() => setModal({isOpen: true, type: 'savingsGoal'})} className=\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\"><PlusCircle className=\"w-5 h-5\" /><span>Add Goal</span></button>\r\n            </header>\r\n            <div className=\"space-y-4\">\r\n                {savingsGoals.length > 0 ? savingsGoals.map(goal => {\r\n                    const progress = goal.goal > 0 ? (goal.current / goal.goal) * 100 : 0;\r\n                    return (\r\n                        <div key={goal.id} className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer\" onClick={() => setModal({isOpen: true, type: 'savingsGoal', data: goal})}>\r\n                            <div className=\"flex justify-between items-center mb-2\">\r\n                                <p className=\"font-bold text-lg\">{goal.name}</p>\r\n                                <p className=\"font-semibold\">${parseFloat(goal.current || 0).toFixed(2)} / ${parseFloat(goal.goal || 0).toFixed(2)}</p>\r\n                            </div>\r\n                             <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4\">\r\n                                <div className=\"bg-blue-600 h-4 rounded-full\" style={{ width: `${progress > 100 ? 100 : progress}%` }}></div>\r\n                            </div>\r\n                        </div>\r\n                    )\r\n                }) : <p className=\"text-center text-gray-500 dark:text-gray-400 py-8\">No savings goals yet.</p>}\r\n            </div>\r\n        </div>\r\n    );\r\n  };\r\n\r\n  const LoansPage = () => {\r\n      return (\r\n        <div>\r\n            <header className=\"mb-6 flex justify-between items-center\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Loans</h1>\r\n                <button onClick={() => setModal({isOpen: true, type: 'loan'})} className=\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\"><PlusCircle className=\"w-5 h-5\" /><span>Add Loan</span></button>\r\n            </header>\r\n            <div className=\"space-y-4\">\r\n                {loans.length > 0 ? loans.map(loan => (\r\n                    <div key={loan.id} className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer\" onClick={() => setModal({isOpen: true, type: 'loan', data: loan})}>\r\n                        <p className=\"font-bold text-lg\">{loan.name}</p>\r\n                        <p className=\"text-gray-600 dark:text-gray-400\">Balance: ${parseFloat(loan.principal || 0).toFixed(2)}</p>\r\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">Interest Rate: {loan.interestRate}% | Min. Payment: ${parseFloat(loan.minimumPayment || 0).toFixed(2)}</p>\r\n                    </div>\r\n                )) : <p className=\"text-center text-gray-500 dark:text-gray-400 py-8\">No loans to track.</p>}\r\n            </div>\r\n        </div>\r\n      );\r\n  };\r\n  \r\n  const SchedulePage = () => {\r\n    const sortedAppointments = [...appointments].sort((a,b) => new Date(a.date) - new Date(b.date));\r\n    const allContacts = useMemo(() => {\r\n        const fromBills = bills.filter(b => b.contactInfo).map(b => ({name: `${b.name} (Bill)`, phone: b.contactInfo, isFromBill: true}));\r\n        return [...fromBills, ...contacts].sort((a,b) => a.name.localeCompare(b.name));\r\n    }, [bills, contacts]);\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"mb-8\">\r\n            <header className=\"mb-6 flex justify-between items-center\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Appointments</h1>\r\n                <button onClick={() => setModal({isOpen: true, type: 'appointment'})} className=\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\"><PlusCircle className=\"w-5 h-5\" /><span>Add</span></button>\r\n            </header>\r\n            <div className=\"space-y-4\">\r\n                {sortedAppointments.length > 0 ? sortedAppointments.map(item => (\r\n                    <div key={item.id} className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700\" onClick={() => setModal({isOpen: true, type: 'appointment', data: item})}>\r\n                        <p className=\"font-bold text-lg\">{item.name}</p>\r\n                        <p className=\"text-gray-600 dark:text-gray-400\">{new Date(item.date).toLocaleDateString(undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} at {item.time}</p>\r\n                        {item.address && <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">Location: {item.address}</p>}\r\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">{item.notes}</p>\r\n                    </div>\r\n                )) : <p className=\"text-center text-gray-500 dark:text-gray-400 py-8\">No appointments scheduled.</p>}\r\n            </div>\r\n        </div>\r\n        <div className=\"mt-12\">\r\n            <header className=\"mb-6 flex justify-between items-center\">\r\n                <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Contacts</h1>\r\n                <button onClick={() => setModal({isOpen: true, type: 'contact'})} className=\"flex items-center space-x-2 px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow\"><PlusCircle className=\"w-5 h-5\" /><span>Add</span></button>\r\n            </header>\r\n            <div className=\"space-y-4\">\r\n                {allContacts.map((item, index) => (\r\n                    <div key={item.id || index} className=\"bg-white dark:bg-gray-800 p-4 rounded-lg shadow cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700\" onClick={() => !item.isFromBill && setModal({isOpen: true, type: 'contact', data: item})}>\r\n                        <p className=\"font-bold text-lg\">{item.name}</p>\r\n                        <p className=\"text-gray-600 dark:text-gray-400\">{item.phone}</p>\r\n                        <p className=\"text-gray-600 dark:text-gray-400\">{item.email}</p>\r\n                        {item.address && <p className=\"text-gray-600 dark:text-gray-400\">{item.address}</p>}\r\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">{item.notes}</p>\r\n                    </div>\r\n                ))}\r\n                {allContacts.length === 0 && <p className=\"text-center text-gray-500 dark:text-gray-400 py-8\">No contacts found.</p>}\r\n            </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const SettingsPage = () => {\r\n      const { theme, setTheme } = useContext(ThemeContext);\r\n      return (\r\n        <div>\r\n            <header className=\"mb-6\"><h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-200\">Settings</h1></header>\r\n            <div className=\"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg\">\r\n                <div className=\"flex justify-between items-center\">\r\n                    <span className=\"font-semibold text-lg\">Theme</span>\r\n                    <select value={theme} onChange={(e) => setTheme(e.target.value)} className=\"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600\">\r\n                        <option value=\"light\">Light</option>\r\n                        <option value=\"dark\">Dark</option>\r\n                        <option value=\"mountain\">Mountain Dawn</option>\r\n                        <option value=\"ocean\">Oceanic Calm</option>\r\n                    </select>\r\n                </div>\r\n                 <div className=\"mt-8\">\r\n                    <h2 className=\"text-xl font-bold mb-2\">Budget ID</h2>\r\n                    <p className=\"text-gray-500 dark:text-gray-400 mb-4\">Share this ID with your partner to sync your budgets.</p>\r\n                     <div className=\"flex items-center justify-center space-x-2 bg-gray-100 dark:bg-gray-700 p-3 rounded-lg\">\r\n                        <span className=\"font-semibold text-gray-600 dark:text-gray-300 break-all\">{budgetID}</span>\r\n                        <button onClick={copyToClipboard} className=\"text-blue-500 hover:text-blue-700 flex-shrink-0\"><Copy className=\"w-5 h-5\"/></button>\r\n                        {copySuccess && <span className=\"text-green-600 text-xs\">{copySuccess}</span>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      );\r\n  };\r\n\r\n  const ItemForm = ({ modalConfig, onSave, onDelete, onClose }) => {\r\n    const { type, data } = modalConfig;\r\n    const [formData, setFormData] = useState(data || {});\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({...prev, [name]: value}));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setIsSaving(true);\r\n        const dataToSave = {...formData};\r\n        if(dataToSave.date) dataToSave.date = new Date(dataToSave.date);\r\n        if(dataToSave.startDate) dataToSave.startDate = new Date(dataToSave.startDate);\r\n        await onSave(type, dataToSave);\r\n        setIsSaving(false);\r\n    };\r\n\r\n    const renderFields = () => {\r\n        switch(type) {\r\n            case 'bill':\r\n            case 'deposit':\r\n            case 'expense':\r\n                 return (\r\n                    <>\r\n                        <input name=\"name\" value={formData.name || ''} onChange={handleChange} placeholder=\"Name\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"number\" name=\"amount\" value={formData.amount || ''} onChange={handleChange} placeholder=\"Amount\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                        <input type=\"date\" name=\"date\" value={formData.date ? (formData.date instanceof Date ? formData.date.toISOString().split('T')[0] : formData.date) : new Date().toISOString().split('T')[0]} onChange={handleChange} className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                         {type === 'bill' && <textarea name=\"contactInfo\" value={formData.contactInfo || ''} onChange={handleChange} placeholder=\"Contact Info (Phone, etc.)\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"/>}\r\n                    </>\r\n                );\r\n            case 'savingsGoal':\r\n                return (\r\n                    <>\r\n                        <input name=\"name\" value={formData.name || ''} onChange={handleChange} placeholder=\"Goal Name (e.g., Emergency Fund)\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"number\" name=\"goal\" value={formData.goal || ''} onChange={handleChange} placeholder=\"Goal Amount\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                        <input type=\"number\" name=\"current\" value={formData.current || ''} onChange={handleChange} placeholder=\"Current Amount\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                    </>\r\n                );\r\n            case 'loan':\r\n                return (\r\n                    <>\r\n                        <input name=\"name\" value={formData.name || ''} onChange={handleChange} placeholder=\"Loan Name (e.g., Car Loan)\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"number\" name=\"principal\" value={formData.principal || ''} onChange={handleChange} placeholder=\"Current Principal Balance\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                        <input type=\"number\" name=\"interestRate\" value={formData.interestRate || ''} onChange={handleChange} placeholder=\"Interest Rate (%)\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                        <input type=\"number\" name=\"minimumPayment\" value={formData.minimumPayment || ''} onChange={handleChange} placeholder=\"Minimum Monthly Payment\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required step=\"0.01\"/>\r\n                    </>\r\n                );\r\n            case 'appointment':\r\n                return (\r\n                    <>\r\n                        <input name=\"name\" value={formData.name || ''} onChange={handleChange} placeholder=\"Appointment Title\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"date\" name=\"date\" value={formData.date ? (formData.date instanceof Date ? formData.date.toISOString().split('T')[0] : formData.date) : ''} onChange={handleChange} className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"time\" name=\"time\" value={formData.time || ''} onChange={handleChange} className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"/>\r\n                        <input type=\"number\" name=\"cost\" value={formData.cost || ''} onChange={handleChange} placeholder=\"Optional Cost\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" step=\"0.01\"/>\r\n                        <textarea name=\"address\" value={formData.address || ''} onChange={handleChange} placeholder=\"Location / Address\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"/>\r\n                        <textarea name=\"notes\" value={formData.notes || ''} onChange={handleChange} placeholder=\"Notes\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"/>\r\n                        <div className=\"pt-2\">\r\n                            <h3 className=\"text-lg font-semibold mb-2 text-gray-800 dark:text-gray-200\">Contact Info (Optional)</h3>\r\n                            <input name=\"contactName\" value={formData.contactName || ''} onChange={handleChange} placeholder=\"Contact Name\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg mb-2\"/>\r\n                            <input type=\"tel\" name=\"contactPhone\" value={formData.contactPhone || ''} onChange={handleChange} placeholder=\"Contact Phone\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"/>\r\n                        </div>\r\n                    </>\r\n                );\r\n            case 'contact':\r\n                return (\r\n                    <>\r\n                        <input name=\"name\" value={formData.name || ''} onChange={handleChange} placeholder=\"Contact Name\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\" required/>\r\n                        <input type=\"tel\" name=\"phone\" value={formData.phone || ''} onChange={handleChange} placeholder=\"Phone Number\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"/>\r\n                        <input type=\"email\" name=\"email\" value={formData.email || ''} onChange={handleChange} placeholder=\"Email Address\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg\"/>\r\n                        <textarea name=\"address\" value={formData.address || ''} onChange={handleChange} placeholder=\"Address\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"/>\r\n                        <textarea name=\"notes\" value={formData.notes || ''} onChange={handleChange} placeholder=\"Notes\" className=\"w-full p-3 bg-gray-100 dark:bg-gray-700 dark:text-white rounded-lg h-24\"/>\r\n                    </>\r\n                );\r\n            default: return null;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-lg relative\">\r\n                <button onClick={onClose} className=\"absolute top-4 right-4 text-gray-400 hover:text-gray-700 dark:hover:text-gray-300\"><X className=\"w-6 h-6\" /></button>\r\n                <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-200 mb-6 capitalize\">{data?.id ? 'Edit' : 'Add'} {type}</h2>\r\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                    {renderFields()}\r\n                    <div className=\"flex justify-between items-center pt-4\">\r\n                        {data?.id && <button type=\"button\" onClick={() => onDelete(type, data.id)} className=\"px-6 py-2 rounded-lg bg-red-600 text-white font-semibold hover:bg-red-700\">Delete</button>}\r\n                        <div className=\"flex-grow\"></div>\r\n                        <div className=\"flex space-x-3\">\r\n                            <button type=\"button\" onClick={onClose} className=\"px-6 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 font-semibold hover:bg-gray-300 dark:hover:bg-gray-500\">Cancel</button>\r\n                            <button type=\"submit\" disabled={isSaving} className=\"px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:opacity-50\">\r\n                                {isSaving ? 'Saving...' : 'Save'}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n  };\r\n\r\n\r\n  // --- Main Render Logic ---\r\n  if (!isAuthReady) return <div className=\"flex items-center justify-center h-screen bg-gray-100 dark:bg-gray-900\"><div className=\"text-xl font-semibold text-gray-600 dark:text-gray-300\">Initializing Secure Session...</div></div>;\r\n  if (!budgetID) return <WelcomeScreen />;\r\n\r\n  return (\r\n    <MainLayout>\r\n      {activeTab === 'timeline' && <TimelinePage currentDate={currentDate} setCurrentDate={setCurrentDate} bills={bills} deposits={deposits} transactions={transactions} totalCurrentSavings={totalCurrentSavings} db={db} getBasePath={getBasePath} />}\r\n      {activeTab === 'savings' && <SavingsPage savingsGoals={savingsGoals} />}\r\n      {activeTab === 'loans' && <LoansPage loans={loans} transactions={transactions} />}\r\n      {activeTab === 'schedule' && <SchedulePage appointments={appointments} contacts={contacts} bills={bills} />}\r\n      {activeTab === 'settings' && <SettingsPage />}\r\n    </MainLayout>\r\n  );\r\n}\r\n\r\nexport default function ThemedApp() {\r\n    return (\r\n        <ThemeProvider>\r\n            <App />\r\n        </ThemeProvider>\r\n    )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}